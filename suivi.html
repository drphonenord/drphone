<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Suivi de réparation — Dr Phone</title>
  <meta name="description" content="Suis l’avancement de ta réparation Dr Phone avec un code de suivi." />
  <style>
    :root{--fg:#0b1220;--muted:#6b7280;--border:#e5e7eb;--ok:#16a34a;--warn:#ca8a04;--brand:#2563eb;--brand2:#06b6d4}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;color:var(--fg);background:#f8fafc}
    .container{max-width:760px;margin:8vh auto;padding:0 16px}
    .card{background:#fff;border:1px solid var(--border);border-radius:16px;padding:20px}
    .btn{display:inline-block;border:1px solid var(--brand);background:linear-gradient(90deg,var(--brand),var(--brand2));color:#fff;padding:10px 16px;border-radius:12px;text-decoration:none;font-weight:700}
    .muted{color:var(--muted)} .row{display:grid;gap:12px;grid-template-columns:1fr auto}
    input{padding:12px;border:1px solid var(--border);border-radius:12px;width:100%}
    .step{border-left:3px solid var(--border);padding-left:10px;margin-left:6px}
    .st{display:inline-block;padding:4px 8px;border-radius:8px;background:#eef2ff}
  </style>

  <style>
    .nav{display:flex;gap:14px;align-items:center;flex-wrap:nowrap}
    .nav a{white-space:nowrap}
    .nav .btn{margin-left:auto}
    .nav-more{position:relative}
    .more-btn{border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px 10px;cursor:pointer}
    .more-menu{position:absolute;top:42px;right:0;background:#fff;border:1px solid var(--border);border-radius:12px;box-shadow:0 12px 32px rgba(2,6,23,.12);padding:8px;display:none;min-width:220px;z-index:30}
    .more-menu a{display:block;padding:8px 10px;border-radius:8px;text-decoration:none;color:var(--fg)}
    .more-menu a:hover{background:#f3f4f6}
    .nav-burger{display:none;margin-left:8px;border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px 10px}
    @media(max-width:1080px){
      .nav a[href="#marques"], .nav a[href="/villes/cambrai.html"], .nav a[href="#avis"], .nav a[href="#devis"]{display:none}
      .nav .btn{order:1;margin-left:0}
      .nav-burger{display:block}
    }
    .mobile-drawer{position:fixed;inset:0;display:none;z-index:50;background:rgba(0,0,0,.15)}
    .mobile-panel{position:absolute;right:10px;top:10px;left:10px;background:#fff;border:1px solid var(--border);border-radius:14px;padding:14px;box-shadow:0 16px 48px rgba(2,6,23,.2)}
    .mobile-panel a{display:block;padding:10px 8px;border-radius:8px}
    .mobile-panel a:hover{background:#f3f4f6}
  </style>

</head>
<body>

  <header class="container" style="display:flex;align-items:center;justify-content:space-between;padding:14px 16px">
    <div style="font-weight:800;font-size:20px">Dr Phone</div>
    <nav class="nav">
      <a href="/#services">Services</a>
      <a href="/reparations.html">Réparations</a>
      <a href="/#marques">Marques</a>
      <a href="/villes/cambrai.html">Zones</a>
      <a href="/#avis">Avis</a>
      <a href="/#devis">Devis</a>
      <a class="btn cta" href="/#rdv">Prendre RDV</a>
      <div class="nav-more">
        <button class="more-btn" aria-haspopup="true" aria-expanded="false">Plus ▾</button>
        <div class="more-menu" role="menu">
          <a href="/reparations.html#diag" role="menuitem">Diagnostic (2 min)</a>
          <a href="/#process" role="menuitem">Process</a>
          <a href="/entreprises.html" role="menuitem">Entreprises</a>
          <a href="/assurance.html" role="menuitem">Assurance</a>
          <a href="/suivi.html" role="menuitem">Suivi</a>
          <a href="/a-propos.html" role="menuitem">À propos</a>
          <a href="/garantie.html" role="menuitem">Garantie</a>
          <a href="/paiement.html" role="menuitem">Paiement</a>
          <a href="/rachat.html" role="menuitem">Rachat</a>
          <a href="/diagnostic.html" role="menuitem">Diagnostic (complet)</a>
          <a href="/confidentialite.html" role="menuitem">Confidentialité</a>
        </div>
      </div>
      <button class="nav-burger" aria-label="Menu" aria-expanded="false">☰</button>
    </nav>
  </header>


  

  <div class="container">
    <div class="card">
      <h1>Suivi de réparation</h1>
      <p class="muted">Entre ton <strong>code</strong> (ex. <code>DRP-2025-001</code>) pour voir l’état.</p>
      <div class="row">
        <input id="code" placeholder="Code ex. DRP-2025-001" />
        <button class="btn" id="btn">Consulter</button>
      </div>
      <div id="out" style="margin-top:16px"></div>
      <p class="muted" style="margin-top:12px">Astuce : en cas de code inconnu, contacte-nous au <a href="tel:+33362020622">03 62 02 06 22</a>.</p>
    </div>
  </div>
  <script>
    async function fetchStatus(code){
      try{
        const r = await fetch('/.netlify/functions/tickets?id='+encodeURIComponent(code));
        const db = await r.json();
        return db[code] || null;
      }catch(e){ return null; }
    }
    function render(o){
      const out=document.getElementById('out'); out.innerHTML='';
      if(!o){ out.innerHTML='<div class="card"><div class="muted">Code introuvable.</div></div>'; return; }
      const html = `
        <div class="card">
          <div><span class="st">Statut</span> <strong>${o.status}</strong></div>
          <div class="muted">Appareil : ${o.model||'-'} — Client : ${o.client||'-'}</div>
          <div class="step" style="margin-top:10px">
            <div class="muted">Dernière mise à jour : ${o.updated||'-'}</div>
            <p>${o.note||''}</p>
          </div>
        </div>`;
      out.innerHTML = html;
    }
    document.getElementById('btn').addEventListener('click', async ()=>{
      const code = document.getElementById('code').value.trim();
      if(!code){ return; }
      const st = await fetchStatus(code);
      render(st);
    });
  </script>

  <footer style="margin-top:56px;background:#fff;border-top:1px solid var(--border)">
    <div class="container" style="padding:24px 16px">
      <div class="cols">
        <div>
          <div style="font-weight:800;font-size:18px">Dr Phone</div>
          <p class="muted">Votre réparateur proche de chez vous — Cambrai & alentours.</p>
          <p class="muted">4T rue Guillaume du Fay, 59400 Cambrai<br>
          <a href="tel:+33362020622">03 62 02 06 22</a> · <a href="mailto:drphonenord@gmail.com">drphonenord@gmail.com</a></p>
          <p class="muted">Lun–Ven 8h–19h · Sam 8h–20h · Dim 10h–20h</p>
        </div>
        <div>
          <div style="font-weight:700">Liens utiles</div>
          <ul class="muted" style="list-style:none;padding:0;margin:8px 0 0 0">
            <li><a href="/reparations.html">Réparations</a></li>
            <li><a href="/reparations.html#diag">Diagnostic (2 min)</a></li>
            <li><a href="/#devis">Demander un devis</a></li>
            <li><a href="/#rdv">Prendre RDV</a></li>
            <li><a href="/suivi.html">Suivi de réparation</a></li>
          </ul>
        </div>
        <div>
          <div style="font-weight:700">Infos</div>
          <ul class="muted" style="list-style:none;padding:0;margin:8px 0 0 0">
            <li><a href="/a-propos.html">À propos</a></li>
            <li><a href="/garantie.html">Garantie & qualité</a></li>
            <li><a href="/paiement.html">Paiement & facturation</a></li>
            <li><a href="/entreprises.html">Entreprises</a></li>
            <li><a href="/assurance.html">Assurance</a></li>
            <li><a href="/confidentialite.html">Confidentialité</a></li>
          </ul>
        </div>
      </div>
      <div class="muted" style="margin-top:16px;font-size:.9rem">© 2025 Dr Phone · Réparateur indépendant — les marques citées restent la propriété de leurs détenteurs.</div>
    </div>
  </footer>


    <script>
      // auto-run if URL contains #CODE
      (function(){
        const h = (location.hash||'').replace('#','').trim();
        if(h){
          document.getElementById('code').value = h;
          document.getElementById('btn').click();
        }
      })();
    </script>
    
</body>
</html>
